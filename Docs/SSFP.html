

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>SSFP &mdash; QUIT  documentation</title>
  

  
  
  
  

  

  
  
    

  

  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Susceptibility" href="Susceptibility.html" />
    <link rel="prev" title="Magnetization Transfer" href="MT.html" /> 

  
  <script src="../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../index.html" class="icon icon-home"> QUIT
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="Contents.html">Categories</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="Relaxometry.html">Relaxometry</a></li>
<li class="toctree-l2"><a class="reference internal" href="Perfusion.html">Perfusion</a></li>
<li class="toctree-l2"><a class="reference internal" href="MT.html">Magnetization Transfer</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">SSFP</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#qi-ssfp-bands">qi_ssfp_bands</a></li>
<li class="toctree-l3"><a class="reference internal" href="#qi-ssfp-ellipse">qi_ssfp_ellipse</a></li>
<li class="toctree-l3"><a class="reference internal" href="#qi-ssfp-planet">qi_ssfp_planet</a></li>
<li class="toctree-l3"><a class="reference internal" href="#qi-ssfp-emt">qi_ssfp_emt</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="Susceptibility.html">Susceptibility</a></li>
<li class="toctree-l2"><a class="reference internal" href="Stats.html">Statistics / GLM Tools</a></li>
<li class="toctree-l2"><a class="reference internal" href="Utilities.html">Utilities</a></li>
<li class="toctree-l2"><a class="reference internal" href="Developer.html">Developer</a></li>
</ul>
</li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">QUIT</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
          <li><a href="Contents.html">Categories</a> &raquo;</li>
        
      <li>SSFP</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/Docs/SSFP.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="ssfp">
<h1>SSFP<a class="headerlink" href="#ssfp" title="Permalink to this headline">¶</a></h1>
<p>The Steady-State Free-Precession (SSFP), or more precisely balanced-SSFP (bSSFP), sequence is one of the oldest NMR sequences and can be used to give high SNR MR images with mixed T1/T2 contrast in very short scan time. However, it suffers from banding artefacts in areas of off-resonance which limit its clinical applicability. This module contains a tool for removing those banding artefacts, and then further tools for quantitative mapping using the ellipse signal model.</p>
<ul class="simple">
<li><a class="reference internal" href="#qi-ssfp-bands">qi_ssfp_bands</a></li>
<li><a class="reference internal" href="#qi-ssfp-ellipse">qi_ssfp_ellipse</a></li>
<li><a class="reference internal" href="#qi-ssfp-planet">qi_ssfp_planet</a></li>
<li><a class="reference internal" href="#qi-ssfp-emt">qi_ssfp_emt</a></li>
</ul>
<div class="section" id="qi-ssfp-bands">
<h2>qi_ssfp_bands<a class="headerlink" href="#qi-ssfp-bands" title="Permalink to this headline">¶</a></h2>
<p>There are several different methods for removing SSFP bands in the literature. Most of them rely on acquiring multiple SSFP images with different phase-increments (also called phase-cycling or phase-cycling patterns). Changing the phase-increments moves the bands to a different location, after which the images can be combined to reduce the banding. The different approaches are discussed further below, but the recommended method is the Geometric Solution which requires complex data.</p>
<p><strong>Example Command Line</strong></p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>qissfpbands ssfp.nii.gz --method<span class="o">=</span>G --2pass --magnitude
</pre></div>
</div>
<p>The SSFP file must be complex-valued to use the Geometric Solution or Complex Average methods. For the other methods magnitude data is sufficient. Phase-increments should be in opposing pairs, e.g. 180 &amp; 0 degrees, 90 &amp; 270 degrees. These should either be ordered in two blocks, e.g. 180, 90, 0, 270, or alternating, e.g. 180, 0, 90, 270.</p>
<p><strong>Outputs</strong></p>
<p>The output filename is the input filename with a suffix that will depend on the method selected (see below).</p>
<p><strong>Important Options</strong></p>
<ul>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">--method</span></code></p>
<blockquote>
<div><p>Choose the band removal method. Choices are:</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">G</span></code> Geometric solution. Suffix will be <code class="docutils literal notranslate"><span class="pre">GSL</span></code> or <code class="docutils literal notranslate"><span class="pre">GSM</span></code></li>
<li><cite>X`</cite> Complex Average. Suffix will be <code class="docutils literal notranslate"><span class="pre">CS</span></code> (for Complex Solution)</li>
<li><code class="docutils literal notranslate"><span class="pre">R</span></code> Root-mean-square. Suffix will be <code class="docutils literal notranslate"><span class="pre">RMS</span></code></li>
<li><code class="docutils literal notranslate"><span class="pre">M</span></code> Maximum of magnitudes. Suffix will be <code class="docutils literal notranslate"><span class="pre">Max</span></code></li>
<li><code class="docutils literal notranslate"><span class="pre">N</span></code> Mean of magnitudes. Suffix will be <code class="docutils literal notranslate"><span class="pre">MagMean</span></code></li>
</ul>
</div></blockquote>
</li>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">--regularise</span></code></p>
<blockquote>
<div><p>The Geometric Solution requires regularisation in noisy areas. Available methods are:</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">M</span></code> Magnitude regularisation as in original paper</li>
<li><code class="docutils literal notranslate"><span class="pre">L</span></code> Line regularisation (unpublished)</li>
<li><code class="docutils literal notranslate"><span class="pre">N</span></code> None</li>
</ul>
<p>The default is <code class="docutils literal notranslate"><span class="pre">L</span></code>. If <code class="docutils literal notranslate"><span class="pre">L</span></code> or <code class="docutils literal notranslate"><span class="pre">M</span></code> are selected, then that character will be appended to the suffix.</p>
</div></blockquote>
</li>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">--2pass,</span> <span class="pre">-2</span></code></p>
<blockquote>
<div><p>Apply the second-pass energy-minimisation filter from the original paper. Can be likened to smoothing the phase data. If selected will append <code class="docutils literal notranslate"><span class="pre">2</span></code> to the suffix.</p>
</div></blockquote>
</li>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">--alt-order</span></code></p>
<blockquote>
<div><p>Phase-increments alternate, e.g. 180, 0, 90, 270. The default is the opposite (two blocks), e.g. 180, 90, 0, 270.</p>
</div></blockquote>
</li>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">--ph-incs</span></code></p>
<blockquote>
<div><p>Number of phase-increments. The default is 4. If you have multiple phase-increments and (for example) multiple flip-angles, <code class="docutils literal notranslate"><span class="pre">qissfpbands</span></code> can process them all in one pass.</p>
</div></blockquote>
</li>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">--ph-order</span></code></p>
<blockquote>
<div><p>The data order is phase-increment varying fastest, flip-angle slowest. The default is the opposite.</p>
</div></blockquote>
</li>
</ul>
<p><strong>References</strong></p>
<ul class="simple">
<li><a class="reference external" href="http://doi.wiley.com/10.1002/mrm.25098">Geometric Solution</a></li>
</ul>
</div>
<div class="section" id="qi-ssfp-ellipse">
<h2>qi_ssfp_ellipse<a class="headerlink" href="#qi-ssfp-ellipse" title="Permalink to this headline">¶</a></h2>
<p>The most important result of Xiang &amp; Hoff’s Geometric Solution paper was that the SSFP signal equation can be expressed as an ellipse in the complex-plane. Shcherbakova built on this and showed it was possible to recover the ellipse parameters <em>G</em>, <em>a</em>, <em>b</em> from at least six phase-increments. They then proceeded to recover T1 &amp; T2 from the ellipse parameters. This utility calculates the ellipse parameters, and <code class="docutils literal notranslate"><span class="pre">qi_ssfp_planet</span></code> then processes those parameters to calculate T1 &amp; T2.</p>
<img alt="SSFP Ellipse Parameters" src="../_images/ellipse.png" />
<p><strong>Example Command Line</strong></p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>qi_ssfp_ellipse ssfp_data.nii.gz &lt; input.json
</pre></div>
</div>
<p>The SSFP file must be complex-valued. At least three pairs of opposing phase-increments are recommended (six images in total).</p>
<p><strong>Outputs</strong></p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">ES_G</span></code> - The Geometric Solution point of the ellipse. Influences the overall size of the ellipse. This is called (M) in the Hoff and Shcherbakova papers, but it is not a measurable magnetization and hence to distinguish it a different letter is used.</li>
<li><code class="docutils literal notranslate"><span class="pre">ES_a</span></code> - The ellipse parameter that along with (G) controls the ellipse size.</li>
<li><code class="docutils literal notranslate"><span class="pre">ES_b</span></code> - The ellipse parameter that determines how flat or circular the ellipse is.</li>
<li><code class="docutils literal notranslate"><span class="pre">ES_theta_0</span></code> - The accrued phase due to off-resonance, divide by <span class="math notranslate nohighlight">\(2\pi TE\)</span> (or <span class="math notranslate nohighlight">\(\pi TR\)</span>) to find the off-resonance frequency.</li>
<li><code class="docutils literal notranslate"><span class="pre">ES_phi_rf</span></code> - The effective phase of the RF pulse.</li>
</ul>
<p><strong>Important Options</strong></p>
<ul>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">--algo,</span> <span class="pre">-a</span></code></p>
<blockquote>
<div><p>There are two available methods for calculating the ellipse parameters</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">h</span></code> Hyper-Ellipse method, similar to that used in the Shcherbakova paper. Can fail when (alpha) falls below the Ernst angle, where there is an inversion of the ellipse properties.</li>
<li><code class="docutils literal notranslate"><span class="pre">d</span></code> Direct non-linear fitting of the data, which does not suffer the above properties. The default.</li>
</ul>
</div></blockquote>
</li>
</ul>
<p><strong>References</strong></p>
<ul class="simple">
<li><a class="reference external" href="http://dx.doi.org/10.1002/mrm.26717">PLANET</a></li>
<li><a class="reference external" href="http://linkinghub.elsevier.com/retrieve/pii/S0167947310004809">Hyper-Ellipse</a></li>
</ul>
</div>
<div class="section" id="qi-ssfp-planet">
<h2>qi_ssfp_planet<a class="headerlink" href="#qi-ssfp-planet" title="Permalink to this headline">¶</a></h2>
<p>Converts the SSFP Ellipse parameters into relaxation times.</p>
<p><strong>Example Command Line</strong></p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>qi_ssfp_planet ES_G.nii.gz ES_a.nii.gz ES_b.nii.gz
</pre></div>
</div>
<p><strong>Outputs</strong></p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">PLANET_T1.nii.gz</span></code> - Longitudinal relaxation time</li>
<li><code class="docutils literal notranslate"><span class="pre">PLANET_T2.nii.gz</span></code> - Transverse relaxation time</li>
<li><code class="docutils literal notranslate"><span class="pre">PLANET_PD.nii.gz</span></code> - Apparent Proton Density</li>
</ul>
<p><strong>References</strong></p>
<ul class="simple">
<li><a class="reference external" href="http://dx.doi.org/10.1002/mrm.26717">PLANET</a></li>
</ul>
</div>
<div class="section" id="qi-ssfp-emt">
<h2>qi_ssfp_emt<a class="headerlink" href="#qi-ssfp-emt" title="Permalink to this headline">¶</a></h2>
<p>Due to the short TR commonly used with SSFP, at high flip-angles the sequence becomes MT weighted. It is hence possible to extract qMT parameters from SSFP data. More details will be in a forthcoming paper.</p>
<p><strong>Example Command Line</strong></p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>qi_ssfp_emt ES_G.nii.gz ES_a.nii.gz ES_b.nii.gz
</pre></div>
</div>
<p><strong>Outputs</strong></p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">EMT_T1f.nii.gz</span></code> - Longitudinal relaxation time of the free water bool</li>
<li><code class="docutils literal notranslate"><span class="pre">EMT_T2f.nii.gz</span></code> - Transverse relaxation time of the free water pool</li>
<li><code class="docutils literal notranslate"><span class="pre">EMT_M0.nii.gz</span></code> - Apparent Proton Density</li>
<li><code class="docutils literal notranslate"><span class="pre">EMT_F.nii.gz</span></code> - Bound pool fraction</li>
<li><code class="docutils literal notranslate"><span class="pre">EMT_kf.nii.gz</span></code> - Forward exchange rate</li>
</ul>
<p><strong>References</strong></p>
<ul class="simple">
<li><a class="reference external" href="http://doi.wiley.com/10.1002/mrm.21056">Bieri et al</a></li>
<li><a class="reference external" href="http://doi.wiley.com/10.1002/mrm.21705">Gloor et al</a></li>
</ul>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="Susceptibility.html" class="btn btn-neutral float-right" title="Susceptibility" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="MT.html" class="btn btn-neutral" title="Magnetization Transfer" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2018, Tobias Wood.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../',
            VERSION:'',
            LANGUAGE:'None',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="../_static/jquery.js"></script>
      <script type="text/javascript" src="../_static/underscore.js"></script>
      <script type="text/javascript" src="../_static/doctools.js"></script>
      <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  <script type="text/javascript" src="../_static/js/theme.js"></script>

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>